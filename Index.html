<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>جدول المحاضرات - المزامنة</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    /* ... (Previous Styles Remain the Same) ... */
    :root {
      --bg: #f4f6fb;
      --card: #ffffff;
      --primary: #2f3a8f;
      --secondary: #e9ecff;
      --text: #1f2937;
      --muted: #6b7280;
      --border: #e5e7eb;
      --radius: 14px;
      --success: #10b981;
    }

    body { margin: 0; font-family: "Cairo", system-ui, sans-serif; background: var(--bg); color: var(--text); }
    .container { max-width: 1100px; margin: auto; padding: 32px 20px 60px; }
    header { text-align: center; margin-bottom: 30px; }
    
    /* Tabs Style */
    .tabs-container { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-bottom: 30px; background: #fff; padding: 15px; border-radius: var(--radius); box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
    .tab-btn { background: transparent; border: 2px solid var(--secondary); color: var(--muted); padding: 10px 20px; border-radius: 50px; font-family: "Cairo", sans-serif; font-weight: 700; cursor: pointer; transition: all 0.3s ease; }
    .tab-btn:hover { border-color: var(--primary); color: var(--primary); }
    .tab-btn.active { background: var(--primary); border-color: var(--primary); color: #fff; }

    /* Content & Tables */
    .subject-content { display: none; animation: fadeIn 0.4s ease-in-out; }
    .subject-content.active-content { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    
    .subject-card { background: var(--card); border-radius: var(--radius); margin-bottom: 28px; border: 1px solid var(--border); overflow: hidden; }
    .card-header { padding: 18px 22px; font-size: 22px; font-weight: 700; color: var(--primary); background: linear-gradient(135deg, var(--secondary), #ffffff); border-bottom: 1px solid var(--border); }
    
    details { border-bottom: 1px solid var(--border); }
    summary { cursor: pointer; padding: 16px 22px; font-weight: 600; background: #fafbff; display: flex; justify-content: space-between; align-items: center; }
    
    .table-wrapper { padding: 12px; background: #fff; }
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 12px; border-bottom: 1px solid var(--border); vertical-align: middle; }
    
    /* Column Widths */
    th.chapter-col { width: 25%; text-align: right; color: var(--primary); background-color: #fcfcfc; }
    td.desc-col { text-align: right; }
    
    /* STATUS TOGGLE STYLE */
    th.status-col { width: 150px; text-align: center; color: var(--muted); }
    td.status-cell { text-align: center; }

    /* Custom Checkbox Design */
    .toggle-checkbox { display: none; }
    .toggle-label {
      display: inline-flex; align-items: center; justify-content: center;
      padding: 6px 12px; border-radius: 20px; cursor: pointer;
      background-color: #eee; color: #777; font-size: 14px; font-weight: bold;
      transition: all 0.3s ease; border: 1px solid #ddd; width: 100px;
    }
    .toggle-label::after { content: "غير جاهز"; }
    
    /* Checked State */
    .toggle-checkbox:checked + .toggle-label {
      background-color: var(--success); color: white; border-color: var(--success);
    }
    .toggle-checkbox:checked + .toggle-label::after { content: "تم الرفع"; }

    @media (max-width: 600px) {
      .tabs-container { flex-wrap: nowrap; overflow-x: auto; justify-content: flex-start; }
      .tab-btn { white-space: nowrap; flex: 0 0 auto; }
      th.chapter-col { width: 30%; font-size: 13px; }
      .toggle-label { padding: 4px 8px; font-size: 12px; width: 70px; }
    }
  </style>
</head>

<body>
<div class="container">
  <header>
    <h1>لوحة متابعة المحاضرات</h1>
    <p>اضغط على الزر عند رفع الأسئلة. سيتم التحديث لدى جميع الأساتذة تلقائياً.</p>
  </header>

  <div class="tabs-container">
    <button class="tab-btn active" onclick="openSubject('chemistry')">الكيمياء</button>
    <button class="tab-btn" onclick="openSubject('biology')">الأحياء</button>
    </div>

  <div id="chemistry" class="subject-content active-content">
    <div class="subject-card">
      <div class="card-header">الكيمياء</div>
      
      <details open>
        <summary>السادس العلمي</summary>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th class="chapter-col">الفصل</th>
                <th class="desc-col">المحاضرة</th>
                <th class="status-col">حالة الأسئلة</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="chapter-col">الفصل الرابع</td>
                <td class="desc-col">محاضرة 6 - التعبير عن الخلية كتابة</td>
                <td class="status-cell">
                  <input type="checkbox" id="chem-g12-lec6" class="toggle-checkbox">
                  <label for="chem-g12-lec6" class="toggle-label"></label>
                </td>
              </tr>
              <tr>
                <td class="chapter-col">الفصل الرابع</td>
                <td class="desc-col">محاضرة 7 - حساب جهد الخلية</td>
                <td class="status-cell">
                  <input type="checkbox" id="chem-g12-lec7" class="toggle-checkbox">
                  <label for="chem-g12-lec7" class="toggle-label"></label>
                </td>
              </tr>
              <tr>
                <td class="chapter-col">الفصل الرابع</td>
                <td class="desc-col">محاضرة 8 - تحديد تلقائية تفاعل الخلية</td>
                <td class="status-cell">
                  <input type="checkbox" id="chem-g12-lec8" class="toggle-checkbox">
                  <label for="chem-g12-lec8" class="toggle-label"></label>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </details>
    </div>
  </div>

  <div id="biology" class="subject-content">
    <div class="subject-card">
      <div class="card-header">الأحياء</div>
      <details open>
        <summary>السادس العلمي</summary>
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th class="chapter-col">الفصل</th>
                <th class="desc-col">المحاضرة</th>
                <th class="status-col">حالة الأسئلة</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="chapter-col">الفصل الثالث</td>
                <td class="desc-col">محاضرة 14 - المتك وتكوين حبوب اللقاح</td>
                <td class="status-cell">
                  <input type="checkbox" id="bio-g12-lec14" class="toggle-checkbox">
                  <label for="bio-g12-lec14" class="toggle-label"></label>
                </td>
              </tr>
              <tr>
                <td class="chapter-col">الفصل الثالث</td>
                <td class="desc-col">محاضرة 15 - المبيض وتكوين البيوض</td>
                <td class="status-cell">
                  <input type="checkbox" id="bio-g12-lec15" class="toggle-checkbox">
                  <label for="bio-g12-lec15" class="toggle-label"></label>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </details>
    </div>
  </div>

  </div>

<script type="module">
  // 1. Import Firebase
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

  // 2. PASTE YOUR CONFIG HERE (From Firebase Console)
  const firebaseConfig = {
    apiKey: "AIzaSyB...", // REPLACE THIS
    authDomain: "YOUR-PROJECT.firebaseapp.com", // REPLACE THIS
    databaseURL: "https://YOUR-PROJECT-default-rtdb.firebaseio.com", // REPLACE THIS
    projectId: "YOUR-PROJECT", // REPLACE THIS
    storageBucket: "YOUR-PROJECT.appspot.com", // REPLACE THIS
    messagingSenderId: "123456...", // REPLACE THIS
    appId: "1:123456..." // REPLACE THIS
  };

  // 3. Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  // 4. Function to Update Database when User Clicks
  function updateStatus(id, isChecked) {
    set(ref(db, 'lectures/' + id), isChecked);
  }

  // 5. Add Event Listeners to all Checkboxes
  const checkboxes = document.querySelectorAll('.toggle-checkbox');
  checkboxes.forEach(box => {
    box.addEventListener('change', (e) => {
      updateStatus(e.target.id, e.target.checked);
    });
  });

  // 6. Listen for Changes from Database (Sync)
  const dbRef = ref(db, 'lectures');
  onValue(dbRef, (snapshot) => {
    const data = snapshot.val();
    if (data) {
      // Loop through the data and update the UI
      Object.keys(data).forEach(key => {
        const checkbox = document.getElementById(key);
        if (checkbox) {
          checkbox.checked = data[key];
        }
      });
    }
  });
</script>

<script>
  // Tab Switching Logic
  function openSubject(subjectId) {
    const contents = document.querySelectorAll('.subject-content');
    contents.forEach(content => content.classList.remove('active-content'));
    const buttons = document.querySelectorAll('.tab-btn');
    buttons.forEach(btn => btn.classList.remove('active'));
    document.getElementById(subjectId).classList.add('active-content');
    event.target.classList.add('active');
  }
</script>

</body>
</html>
